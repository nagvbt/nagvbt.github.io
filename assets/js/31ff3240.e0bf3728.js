"use strict";(self.webpackChunkNBT=self.webpackChunkNBT||[]).push([["60119"],{36983:function(e,t,n){n.r(t),n.d(t,{frontMatter:()=>i,default:()=>h,toc:()=>c,metadata:()=>s,assets:()=>l,contentTitle:()=>a});var s=JSON.parse('{"id":"COM-ATL/ActiveX","title":"ActiveX Control Tutorial","description":"Basics of ActiveX Controls","source":"@site/docs/COM-ATL/ActiveX.md","sourceDirName":"COM-ATL","slug":"/COM-ATL/ActiveX","permalink":"/docs/COM-ATL/ActiveX","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"ATL Tutorial","permalink":"/docs/COM-ATL/ATL"},"next":{"title":"ATL, ActiveX FAQ","permalink":"/docs/COM-ATL/atl-faq"}}'),r=n(85893),o=n(50065);let i={sidebar_position:4},a="ActiveX Control Tutorial",l={},c=[{value:"Basics of ActiveX Controls",id:"basics-of-activex-controls",level:2},{value:"Steps to create an ActiveX Control",id:"steps-to-create-an-activex-control",level:2},{value:"Descriptions of the Generated classes &amp; Notes",id:"descriptions-of-the-generated-classes--notes",level:2},{value:"Dispatch Maps",id:"dispatch-maps",level:3},{value:"Parameters",id:"parameters",level:4},{value:"Using MathOCX.ocx control in the HTML Page",id:"using-mathocxocx-control-in-the-html-page",level:4}];function d(e){let t={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"activex-control-tutorial",children:"ActiveX Control Tutorial"})}),"\n",(0,r.jsx)(t.h2,{id:"basics-of-activex-controls",children:"Basics of ActiveX Controls"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Definition:"}),"\xa0ActiveX controls are COM components which are self-registering and Implements standard interfaces that deal specifically with GUI-based tasks such as rendering, sizing, activation, and property persistence."]}),"\n",(0,r.jsx)(t.p,{children:"An ActiveX control is anything you might see in the Toolbox of Visual studio (i.e. EditBox, combobox e.t.c) we can even use the Activex controls in web pages using"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Connectable Object"})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.em,{children:"Connectable Object:"})," is a COM Component or object that defines and uses an outgoing interface."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.em,{children:"Sink"}),": A client that implements the outgoing interface of a component is called sink."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Control Container:"})," An application (Dialog or View ) that houses ActiveX control is called the control container. The control container communicates with a ActiveX control via methods and properties of a control."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"ActiveX Control Properties:"})," There are two types of properties 1.Stock Properties 2.Custom properties"]}),"\n",(0,r.jsx)(t.p,{children:"1.Stock Properties Stack properties are common properties (Caption, foreground and background colors) that most controls expose. The COleControl data members provides stock properties implementation and also provides notification functions for the stock properties."}),"\n",(0,r.jsx)(t.p,{children:"2.Custom properties Custom properties are the properties which are specific to the control. There are four different ways to implement Custom properties. a. Member variable: b. Member variable with notification function: c. Get/Set methods d. Parameterized (property array)"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"ActiveX Control Methods"})," There are two types of methods 1.Stock methods 2.Custom methods"]}),"\n",(0,r.jsx)(t.p,{children:"1.Stock methods The COleControl provides the stock methods implementation. there are only two stock properties DoClick() - fires an event from the control Refresh() - updates the control appearance"}),"\n",(0,r.jsx)(t.p,{children:"2.Custom methods Custom methods are the methods which are specific to the control."}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"ActiveX Control Events"})," A member function of an outgoing interface is called an event. An activeX controlcan notify the containerof a state change using events. There are two types of Events 1.Stock Events 2.Custom Events"]}),"\n",(0,r.jsx)(t.p,{children:"1.Stock Events The COleControl provides the common stock Events implementation like mouse button clicks and keyboard input."}),"\n",(0,r.jsx)(t.p,{children:"2.Custom Events Custom Events are the events which are specific to the control."}),"\n",(0,r.jsx)(t.h2,{id:"steps-to-create-an-activex-control",children:"Steps to create an ActiveX Control"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"Open VS 2008"}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:'File->NewProject give the project name as "MathOCX" 3.Click OK and Click Finish'}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"To add a method"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:'Go to class View, Expand "MathOCXLib"'}),"\n",(0,r.jsx)(t.li,{children:"RightClick on the \"_DMathOCX\" and click 'Add >' Add Method..."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"'Add Method Wizard' Dialog will be displayed as shown in below fig Add the function return type, parameter and function names as Add and Sub"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-cpp",children:"DOUBLE Add(DOUBLE i, DOUBLE j)\r\n\r\nDOUBLE Sub(DOUBLE i, DOUBLE j);\n"})}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"Three Major classes are created"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-cpp",children:"class\xa0CMathOCXApp :\xa0public\xa0COleControlModule\r\nclass\xa0CMathOCXCtrl :\xa0public\xa0COleControl\r\nclass\xa0CMathOCXPropPage :\xa0public\xa0COlePropertyPage\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"descriptions-of-the-generated-classes--notes",children:"Descriptions of the Generated classes & Notes"}),"\n",(0,r.jsx)(t.p,{children:"`class\xa0CMathOCXApp :\xa0public\xa0COleControlModule -> CWinApp``"}),"\n",(0,r.jsx)(t.p,{children:"COleControlModule\xa0provides member functions for initializing control module it is an application object for running the ActivexControl. Only one global object is present."}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.code,{children:"class\xa0CMathOCXCtrl :\xa0public\xa0COleControl"})}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"COleControl\xa0Derived from CWnd, this class inherits all the functionality of a Windows window object plus additional functionality specific to OLE, such as event firing and the ability to support methods and properties."}),"\n",(0,r.jsx)(t.li,{children:"COleControl\xa0has\xa0a dispatch map, which is used to expose a set of functions (called methods) and attributes (called properties) to the control user."}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"dispatch-maps",children:"Dispatch Maps"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"OLE Automation provides ways to call methods and to access properties across applications."}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:'The mechanism supplied by the MFC for dispatching these requests is the "dispatch map," which designates the internal and external names of object functions and properties, as well as the data types of the properties themselves and of function arguments.'}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.code,{children:"DISP_FUNCTION(theClass, pszName, pfnMember, vtRetVal, vtsParams )"})}),"\n",(0,r.jsx)(t.h4,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"theClass -\xa0Name of the class."}),"\n",(0,r.jsx)(t.li,{children:"pszName -\xa0External name of the function."}),"\n",(0,r.jsx)(t.li,{children:"pfnMember -\xa0Name of the member function."}),"\n",(0,r.jsx)(t.li,{children:"vtRetVal -\xa0A value specifying the function's return type."}),"\n",(0,r.jsx)(t.li,{children:"vtsParams -\xa0A space-separated list of one or more constants specifying the function's parameter list."}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:'Example:\xa0DISP_FUNCTION_ID(CMathOCXCtrl,\xa0"Add", dispidAdd, Add, VT_R8, VTS_R8 VTS_R8)'}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-cpp",children:"class\xa0CMathOCXPropPage :\xa0public\xa0COlePropertyPage\n"})}),"\n",(0,r.jsx)(t.p,{children:"Used to display the properties of a custom control in a graphical interface, similar to a dialog box."}),"\n",(0,r.jsx)(t.h4,{id:"using-mathocxocx-control-in-the-html-page",children:"Using MathOCX.ocx control in the HTML Page"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-html",children:'<HTML>\r\n<HEAD>\r\n<META NAME="GENERATOR" Content="Microsoft Visual Studio 8.0">\r\n<TITLE></TITLE>\r\n<style type="text/css">\r\n .style1 {\r\n    width: 25%;\r\n    }\r\n .style2 {\r\n    color: #0000CC;\r\n    font-weight: 700;\r\n    }\r\n .style3 {\r\n    width: 213px;\r\n    }\r\n</style>\r\n</HEAD>\r\n\r\n<script type="text/javascript">\r\n    function Button1_onclick() {\r\n        //Call the MathOCX Add Method\r\n        Result.value = MathOCX.Add(Text1.value, Text2.value);\r\n    }\r\n<\/script>\r\n\r\n<BODY onload="initPage()" scroll="no">\r\n    <table class="style1">\r\n        <tr>\r\n            <td class="style2" colspan="2">Addition of two numbers using MathOCX ActiveX Control </td>\r\n        </tr>\r\n        <tr>\r\n            <td class="style3">Enter number :</td>\r\n            <td><input id="Text1" type="text" /></td>\r\n        </tr>\r\n        <tr>\r\n            <td class="style3"> Enter number :</td>\r\n            <td><input id="Text2" type="text" /></td>\r\n        </tr>\r\n        <tr>\r\n            <td class="style3"> <input id="Button1" type="button" value="Add" onclick="return Button1_onclick()" />\r\n                Result:</td>\r\n            <td>\r\n                <input id="Result" type="text" />\r\n            </td>\r\n        </tr>\r\n    </table>\r\n\r\n\x3c!--Initialize the <span class="hiddenSpellError" pre="the ">MathOCX</span> <span class="hiddenSpellError" pre="">Activex</span> Control using the control GUID --\x3e\r\n</pre>\r\n<pre>\r\n<pre>\r\n style="left: 0px; top: 0px" width="1" viewastext>\r\n            <param name="_Version" value="65536"/>\r\n            <param name="_ExtentX" value="26"/>\r\n            <param name="_ExtentY" value="26"/>\r\n            <param name="_StockProps" value="0"/>\r\n      </object>\r\n\r\n</BODY>\r\n</HTML>\n'})})]})}function h(e={}){let{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},50065:function(e,t,n){n.d(t,{Z:()=>a,a:()=>i});var s=n(67294);let r={},o=s.createContext(r);function i(e){let t=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);