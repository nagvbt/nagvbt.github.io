"use strict";(self.webpackChunknagvbt=self.webpackChunknagvbt||[]).push([[25883],{3905:(n,t,e)=>{e.d(t,{Zo:()=>d,kt:()=>m});var a=e(67294);function o(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function r(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,a)}return e}function l(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?r(Object(e),!0).forEach((function(t){o(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):r(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function p(n,t){if(null==n)return{};var e,a,o=function(n,t){if(null==n)return{};var e,a,o={},r=Object.keys(n);for(a=0;a<r.length;a++)e=r[a],t.indexOf(e)>=0||(o[e]=n[e]);return o}(n,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);for(a=0;a<r.length;a++)e=r[a],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(n,e)&&(o[e]=n[e])}return o}var c=a.createContext({}),i=function(n){var t=a.useContext(c),e=t;return n&&(e="function"==typeof n?n(t):l(l({},t),n)),e},d=function(n){var t=i(n.components);return a.createElement(c.Provider,{value:t},n.children)},g="mdxType",C={inlineCode:"code",wrapper:function(n){var t=n.children;return a.createElement(a.Fragment,{},t)}},s=a.forwardRef((function(n,t){var e=n.components,o=n.mdxType,r=n.originalType,c=n.parentName,d=p(n,["components","mdxType","originalType","parentName"]),g=i(e),s=o,m=g["".concat(c,".").concat(s)]||g[s]||C[s]||r;return e?a.createElement(m,l(l({ref:t},d),{},{components:e})):a.createElement(m,l({ref:t},d))}));function m(n,t){var e=arguments,o=t&&t.mdxType;if("string"==typeof n||o){var r=e.length,l=new Array(r);l[0]=s;var p={};for(var c in t)hasOwnProperty.call(t,c)&&(p[c]=t[c]);p.originalType=n,p[g]="string"==typeof n?n:o,l[1]=p;for(var i=2;i<r;i++)l[i]=e[i];return a.createElement.apply(null,l)}return a.createElement.apply(null,e)}s.displayName="MDXCreateElement"},19437:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>C,frontMatter:()=>r,metadata:()=>p,toc:()=>i});var a=e(87462),o=(e(67294),e(3905));const r={title:"How to Expand and Contract a MFC Dialog ?",date:"2012-04-01",categories:["c-cpp-mfc-vcpp"],tags:["MFC","vc"]},l=void 0,p={permalink:"/blog/2012/04/01/how-to-expand-and-contract-a-mfc-dialog-using-cexpandcontracthelper-class",source:"@site/blog/2012-04-01-how-to-expand-and-contract-a-mfc-dialog-using-cexpandcontracthelper-class.md",title:"How to Expand and Contract a MFC Dialog ?",description:"This article gives the ability to make MFC dialogs expand or contract. The\xa0CExpandContractHelper simplifies the process to \xa0expand or contract MFC Dialog.",date:"2012-04-01T00:00:00.000Z",formattedDate:"April 1, 2012",tags:[{label:"MFC",permalink:"/blog/tags/mfc"},{label:"vc",permalink:"/blog/tags/vc"}],readingTime:2.65,hasTruncateMarker:!1,authors:[],frontMatter:{title:"How to Expand and Contract a MFC Dialog ?",date:"2012-04-01",categories:["c-cpp-mfc-vcpp"],tags:["MFC","vc"]},prevItem:{title:"Simple Stack Program in C++",permalink:"/blog/2012/04/02/stack"},nextItem:{title:"Step by Step tutorial to create MFC ActiveX Control which can be used in HTML Pages",permalink:"/blog/2012/04/01/step-by-step-tutorial-to-create-mfc-activex-control-which-can-be-used-in-html-pages"}},c={authorsImageUrls:[]},i=[],d={toc:i},g="wrapper";function C(n){let{components:t,...e}=n;return(0,o.kt)(g,(0,a.Z)({},d,e,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This article gives the ability to make MFC dialogs expand or contract. The\xa0CExpandContractHelper simplifies the process to \xa0expand or contract MFC Dialog."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://skydrive.live.com/embed?cid=A4632B15B9474D67&resid=A4632B15B9474D67%21454&authkey=AKZzXVcg-7nn7jg"})),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://skydrive.live.com/embed?cid=A4632B15B9474D67&resid=A4632B15B9474D67%21454&authkey=AKZzXVcg-7nn7jg"})),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Steps to use CExpandContractHelper\xa0:")," 1. Create Dialog Based application 2. Place the controls as shown below 3. Add the CExpandContractHelper.cpp & CExpandContractHelper.h files to the project 4. Create the in the Dialog class CExpandContractHelper","*"," m","_","pECH;"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c"},"CExpandDialogDlg::CExpandDialogDlg(CWnd\\* pParent /\\*=NULL\\*/)\n    : CDialog(CExpandDialogDlg::IDD, pParent)\n{\n    m\\_hIcon = AfxGetApp()-&gt;LoadIcon(IDR\\_MAINFRAME);\n    //Step - 1 Create CExpandContractHelper\n    m\\_pECH = new CExpandContractHelper(IDC\\_PIC\\_START, IDC\\_PIC\\_END, this);\n}\n")),(0,o.kt)("p",null,"5","."," Call ExpandContract in the OnInitDialog"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c"},"BOOL CExpandDialogDlg::OnInitDialog()\n{\n    CDialog::OnInitDialog();\n    SetIcon(m\\_hIcon, TRUE);         // Set big icon\n    SetIcon(m\\_hIcon, FALSE);        // Set small icon\n    //Step - 2 Call ExpandContract\n    m\\_pECH-&gt;ExpandContract((CButton\\*)GetDlgItem(IDC\\_BN\\_EXPAND\\_CONTRACT));\n    return TRUE;\n}\n")),(0,o.kt)("p",null,"6","."," Call ExpandContract in the button handler OnBnClickedBnExpandContract"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c"},"void CExpandDialogDlg::OnBnClickedBnExpandContract()\n{\n    //Step - 3 Call ExpandContract\n    m\\_pECH-&gt;ExpandContract((CButton\\*)GetDlgItem(IDC\\_BN\\_EXPAND\\_CONTRACT));\n}\n")),(0,o.kt)("p",null,"CExpandContractHelper class"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c"},"//////////////////////////////////////////////////\n// Purpose: To exapand or contract a dialog control\n// Author : nagvbt.blogspot.com\n//////////////////////////////////////////////////\nclass CExpandContractHelper\n{\npublic:\n    CExpandContractHelper(UINT nStart, UINT nEnd, CDialog\\* dlg);\n    ~CExpandContractHelper(void);\nprotected:\n    // ID of start picture control\n    UINT m\\_nStart;\n    // ID of end picture control\n    UINT m\\_nEnd;\n    CDialog\\* m\\_dlg;\n    CButton\\* m\\_pButton;\n    CString m\\_sExpand;\n    CString m\\_sContract;\npublic:\n    void ExpandContract(CButton\\* pButton);\nprotected:\n    BOOL IsExpand();\n};\n")),(0,o.kt)("p",null,"CExpandContractHelper.cpp"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c"},'#include "StdAfx.h"\n#include "ExpandContractHelper.h"\nCExpandContractHelper::~CExpandContractHelper(void)\n{\n}\nCExpandContractHelper::CExpandContractHelper(\n    UINT nStart, // Start Picture control ID\n    UINT nEnd,   // End  Picture control ID\n    CDialog \\*dlg // Dialog pointer\n    )\n{\n    m\\_nStart = nStart;\n    m\\_nEnd   = nEnd;\n    m\\_dlg    = dlg;\n}\nBOOL CExpandContractHelper::IsExpand()\n{\n    // 1 - Load button caption Expand/Contact\n    m\\_sExpand = "&amp;Expand &gt;&gt;";\n    m\\_sContract = "&lt;&lt; &amp;Contract";\n    // 2 - Find out if we need to expand or collapse the dialog\n    CString strCaption;\n    m\\_pButton-&gt;GetWindowText( strCaption );\n    BOOL bExpand = ( strCaption == m\\_sExpand ); // Collapse by default\n    return bExpand;\n}\nvoid CExpandContractHelper::ExpandContract(\n    CButton\\* pButton  // Expand Contract button pointer\n    )\n{\n    m\\_pButton = pButton;\n    // 3 - Get current dialog window rectangle\n    CRect rcDialog;\n    m\\_dlg-&gt;GetWindowRect( &amp;rcDialog );\n    int nNewHeight = -1;\n    if( IsExpand() )\n    {\n        // 4a - Change Expand/Contract button caption\n        pButton-&gt;SetWindowText( m\\_sContract );\n        // 4b - Calculate new dialog height\n        CWnd\\* pWndLarge = m\\_dlg-&gt;GetDlgItem( m\\_nEnd );\n        ASSERT\\_VALID( pWndLarge );\n        CRect rcLarge;\n        pWndLarge-&gt;GetWindowRect( &amp;rcLarge );\n        nNewHeight = rcLarge.top-rcDialog.top;\n    }\n    else\n    {\n        // 5a - Change Expand/Contract button caption\n        pButton-&gt;SetWindowText( m\\_sExpand );\n        // 5b - Calculate new dialog height\n        CWnd\\* pWndSmall = m\\_dlg-&gt;GetDlgItem( m\\_nStart );\n        ASSERT\\_VALID( pWndSmall );\n        pWndSmall-&gt;ShowWindow(FALSE);\n        CRect rcSmall;\n        pWndSmall-&gt;GetWindowRect( &amp;rcSmall );\n        nNewHeight = rcSmall.top-rcDialog.top;\n    }\n    // 6 - Set new dialog height\n    ASSERT( nNewHeight &gt; 0 );\n    m\\_dlg-&gt;SetWindowPos( NULL, 0, 0,\n                        rcDialog.Width(), nNewHeight,\n                        SWP\\_NOMOVE | SWP\\_NOZORDER );\n    // 7 - Set the enabled state for each control depending on whether\n    // the control is currently visible or not\n    CWnd\\* pWndControl = m\\_dlg-&gt;GetWindow( GW\\_CHILD );\n    while( pWndControl != NULL )\n    {\n        CRect rcControl;\n        pWndControl-&gt;GetWindowRect( &amp;rcControl );\n        pWndControl-&gt;EnableWindow( rcControl.top &lt;= rcDialog.top + nNewHeight );\n        pWndControl = pWndControl-&gt;GetWindow( GW\\_HWNDNEXT );\n    }\n    // 8 - Check if a control still has the focus\n    // (can lose it if the active control becomes disabled)\n    CWnd\\* pWndActiveControl = CWnd::GetFocus();\n    if( pWndActiveControl == NULL )\n    {\n        // 9 - Set focus to "first" control on dialog\n        CWnd\\* pWndFirstControl = m\\_dlg-&gt;GetNextDlgTabItem( NULL );\n        ASSERT\\_VALID( pWndFirstControl );\n        ASSERT( pWndFirstControl-&gt;IsWindowEnabled() );\n        pWndFirstControl-&gt;SetFocus();\n    }\n}\n')))}C.isMDXComponent=!0}}]);