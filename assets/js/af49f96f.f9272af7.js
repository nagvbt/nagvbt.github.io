"use strict";(self.webpackChunknagvbt=self.webpackChunknagvbt||[]).push([[77060],{3905:(t,e,n)=>{n.d(e,{Zo:()=>c,kt:()=>h});var a=n(67294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},l=Object.keys(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var s=a.createContext({}),p=function(t){var e=a.useContext(s),n=e;return t&&(n="function"==typeof t?t(e):o(o({},e),t)),n},c=function(t){var e=p(t.components);return a.createElement(s.Provider,{value:e},t.children)},d="mdxType",u={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},m=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,l=t.originalType,s=t.parentName,c=i(t,["components","mdxType","originalType","parentName"]),d=p(n),m=r,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||l;return n?a.createElement(h,o(o({ref:e},c),{},{components:n})):a.createElement(h,o({ref:e},c))}));function h(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var l=n.length,o=new Array(l);o[0]=m;var i={};for(var s in e)hasOwnProperty.call(e,s)&&(i[s]=e[s]);i.originalType=t,i[d]="string"==typeof t?t:r,o[1]=i;for(var p=2;p<l;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},55087:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const l={title:"Step by Step tutorial to create MFC ActiveX Control which can be used in HTML Pages",date:"2012-04-01",categories:["com-dcom-atl"],tags:["atl","mfc"]},o=void 0,i={permalink:"/blog/2012/04/01/step-by-step-tutorial-to-create-mfc-activex-control-which-can-be-used-in-html-pages",source:"@site/blog/2012-04-01-step-by-step-tutorial-to-create-mfc-activex-control-which-can-be-used-in-html-pages.md",title:"Step by Step tutorial to create MFC ActiveX Control which can be used in HTML Pages",description:"Definition:\xa0ActiveX controls are COM components which are self-registering and Implements standard interfaces that deal specifically with GUI-based tasks such as rendering, sizing, activation, and property persistence.",date:"2012-04-01T00:00:00.000Z",formattedDate:"April 1, 2012",tags:[{label:"atl",permalink:"/blog/tags/atl"},{label:"mfc",permalink:"/blog/tags/mfc"}],readingTime:2.615,hasTruncateMarker:!1,authors:[],frontMatter:{title:"Step by Step tutorial to create MFC ActiveX Control which can be used in HTML Pages",date:"2012-04-01",categories:["com-dcom-atl"],tags:["atl","mfc"]},prevItem:{title:"How to Expand and Contract a MFC Dialog ?",permalink:"/blog/2012/04/01/how-to-expand-and-contract-a-mfc-dialog-using-cexpandcontracthelper-class"},nextItem:{title:"Invoke Native C++ DLL from .NET Code",permalink:"/blog/2012/03/30/invoke-native-c-dll-from-net-code"}},s={authorsImageUrls:[]},p=[],c={toc:p},d="wrapper";function u(t){let{components:e,...n}=t;return(0,r.kt)(d,(0,a.Z)({},c,n,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Definition:"),"\xa0ActiveX controls are COM components which are self-registering and Implements standard interfaces that deal specifically with GUI-based tasks such as rendering, sizing, activation, and property persistence."),(0,r.kt)("p",null,"An ActiveX control is anything you might see in the Toolbox of Visual studio (i.e. EditBox, combobox e.t.c) we can even use the Activex controls in web pages using and handling events with Javascript."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Steps")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Open VS 2008")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'File->NewProject give the project name as "MathOCX" 3.Click OK and Click Finish')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"To add a method"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},'Go to class View, Expand "MathOCXLib"'),(0,r.kt)("li",{parentName:"ul"},'RightClick on the "',"_","DMathOCX\" and click 'Add >' Add Method..."))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"'Add Method Wizard' Dialog will be displayed as shown in below fig Add the function returntype, parameter and function names as Add and Sub"),(0,r.kt)("p",{parentName:"li"},"DOUBLE Add(DOUBLE i, DOUBLE j)"),(0,r.kt)("p",{parentName:"li"},"DOUBLE Sub(DOUBLE i, DOUBLE j);"),(0,r.kt)("p",{parentName:"li"},"4","."," Three Major classes are created"),(0,r.kt)("p",{parentName:"li"},"class\xa0CMathOCXApp :\xa0public\xa0COleControlModule"),(0,r.kt)("p",{parentName:"li"},"class\xa0CMathOCXCtrl :\xa0public\xa0COleControl"),(0,r.kt)("p",{parentName:"li"},"class\xa0CMathOCXPropPage :\xa0public\xa0COlePropertyPage"),(0,r.kt)("h1",{parentName:"li",id:"descriptions-of-the-generated-classes--notes"},(0,r.kt)("strong",{parentName:"h1"},"Descriptions of the Generated classes & Notes")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"class\xa0CMathOCXApp :\xa0public\xa0COleControlModule -> CWinApp")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"COleControlModule\xa0provides")," member functions for initializing control module it is an application object for running the ActivexControl. Only one global object is present."),(0,r.kt)("p",{parentName:"li"},"class\xa0CMathOCXCtrl :\xa0public\xa0COleControl"),(0,r.kt)("p",{parentName:"li"},"1.COleControl\xa0Derived from CWnd, this class inherits all the functionality of a Windows window object plus additional functionality specific to OLE, such as event firing and the ability to support methods and properties."))),(0,r.kt)("p",null,"2.\xa0COleControl\xa0has\xa0a dispatch map, which is used to expose a set of functions (called methods) and attributes (called properties) to the control user."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Dispatch Maps")," 1. OLE Automation provides ways to call methods and to access properties across applications."),(0,r.kt)("p",null,"2",".",' The mechanism supplied by the MFC for dispatching these requests is the "dispatch map," which designates the internal and external names of object functions and properties, as well as the data types of the properties themselves and of function arguments.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"DISP","_","FUNCTION(theClass, pszName, pfnMember, vtRetVal, vtsParams )")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Parameters")," theClass -\xa0Name of the class. pszName -\xa0External name of the function. pfnMember -\xa0Name of the member function. vtRetVal -\xa0A value specifying the function's return type. vtsParams -\xa0A space-separated list of one or more constants specifying the function's parameter list."),(0,r.kt)("p",null,"Example:\xa0DISP","_","FUNCTION","_",'ID(CMathOCXCtrl,\xa0"Add", dispidAdd, Add, VT',"_","R8, VTS","_","R8 VTS","_","R8)"),(0,r.kt)("p",null,"class\xa0CMathOCXPropPage :\xa0public\xa0COlePropertyPage"),(0,r.kt)("p",null,"Used to display the properties of a custom control in a graphical interface, similar to a dialog box."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Using MathOCX.ocx control in the HTML Page")),(0,r.kt)("p",null,"[",'sourcecode language="html"',"]","\n","<","HTML",">","\n","<","HEAD",">","\n","<",'META NAME="GENERATOR" Content="Microsoft Visual Studio 8.0"',">","\n","<","TITLE",">","<","/TITLE",">","\n","<",'style type="text/css"',">","\n.style1\n{\nwidth: 25%;\n}\n.style2\n{ color: #0000CC;\nfont-weight: 700;\n}\n.style3\n{\nwidth: 213px;\n}\n","<","/style",">","\n","<","/HEAD",">"),(0,r.kt)("p",null,"<",'script type="text/javascript"',">","\nfunction Button1","_","onclick() {"),(0,r.kt)("p",null," //Call the MathOCX Add Method\nResult.value = MathOCX.Add(Text1.value, Text2.value);\n}\n","<","/script",">"),(0,r.kt)("p",null,"<",'BODY onload="initPage()" scroll="no"',">","\n","<",'table class="style1"',">","\n","<","tr",">","\n","<",'td class="style2" colspan="2"',">","\nAddition of two numbers using MathOCX ActiveX Control\n","<","/tr",">","\n","<","tr",">","\n","<",'td class="style3"',">","\nEnter number :","<","/td",">","\n","<","td",">","\n","<",'input id="Text1" type="text" /',">","<","/td",">","\n","<","/tr",">","\n","<","tr",">","\n","<",'td class="style3"',">","\nEnter number :","<","/td",">","\n","<","td",">","\n","<",'input id="Text2" type="text" /',">","<","/td",">","\n","<","/tr",">","\n","<","tr",">","\n","<",'td class="style3"',">"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'&lt;input id="Button1" type="button" value="Add" onclick="return Button1\\_onclick()" /&gt;\n            Result:&lt;/td&gt;\n        &lt;td&gt;\n            &lt;input id="Result" type="text" /&gt;\n        &lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/table&gt;\n')),(0,r.kt)("p",null,"<","!--Initialize the ","<",'span class="hiddenSpellError" pre="the "',">","MathOCX","<","/span",">"," ","<",'span class="hiddenSpellError" pre=""',">","Activex","<","/span",">"," Control using the control GUID --",">","<","/pre",">","\n","&","nbsp;\n","<","pre",">","\n","<","pre",">",'\nstyle="left: 0px; top: 0px" width="1" viewastext',">","\n","<",'param name="',"_",'Version" value="65536"/',">","\n","<",'param name="',"_",'ExtentX" value="26"/',">","\n","<",'param name="',"_",'ExtentY" value="26"/',">","\n","<",'param name="',"_",'StockProps" value="0"/',">","\n","<","/object",">"),(0,r.kt)("p",null,"<","/BODY",">","\n","<","/HTML",">"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"")))}u.isMDXComponent=!0}}]);