"use strict";(self.webpackChunknagvbt=self.webpackChunknagvbt||[]).push([[88428],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=p(n),m=r,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||l;return n?a.createElement(h,o(o({ref:t},c),{},{components:n})):a.createElement(h,o({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[d]="string"==typeof e?e:r,o[1]=i;for(var p=2;p<l;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},49253:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const l={tags:["ATL","MFC","Tutorial"]},o="Tutorial to create MFC ActiveX Control which can be used in HTML Pages",i={permalink:"/blog/2012/04/01/mfc-activex-control-which-can-be-used-in-html-pages",source:"@site/blog/2012-04-01-mfc-activex-control-which-can-be-used-in-html-pages.md",title:"Tutorial to create MFC ActiveX Control which can be used in HTML Pages",description:"Definition:\xa0ActiveX controls are COM components which are self-registering and Implements standard interfaces that deal specifically with GUI-based tasks such as rendering, sizing, activation, and property persistence.",date:"2012-04-01T00:00:00.000Z",formattedDate:"April 1, 2012",tags:[{label:"ATL",permalink:"/blog/tags/atl"},{label:"MFC",permalink:"/blog/tags/mfc"},{label:"Tutorial",permalink:"/blog/tags/tutorial"}],readingTime:2.66,hasTruncateMarker:!1,authors:[],frontMatter:{tags:["ATL","MFC","Tutorial"]},prevItem:{title:"How to Expand and Contract a MFC Dialog ?",permalink:"/blog/2012/04/01/expand-and-contract-a-mfc-dialog"},nextItem:{title:"Invoke Native C++ DLL from .NET Code",permalink:"/blog/2012/03/30/invoke-native-c-dll-from-net-code"}},s={authorsImageUrls:[]},p=[{value:"Descriptions of the Generated classes &amp; Notes",id:"descriptions-of-the-generated-classes--notes",level:2}],c={toc:p},d="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Definition:"),"\xa0ActiveX controls are COM components which are self-registering and Implements standard interfaces that deal specifically with GUI-based tasks such as rendering, sizing, activation, and property persistence."),(0,r.kt)("p",null,"An ActiveX control is anything you might see in the Toolbox of Visual studio (i.e. EditBox, combobox e.t.c) we can even use the Activex controls in web pages using and handling events with Javascript."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Steps")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Open VS 2008")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'File->NewProject give the project name as "MathOCX" 3.Click OK and Click Finish')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"To add a method"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},'Go to class View, Expand "MathOCXLib"'),(0,r.kt)("li",{parentName:"ul"},"RightClick on the \"_DMathOCX\" and click 'Add >' Add Method..."))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"'Add Method Wizard' Dialog will be displayed as shown in below fig Add the function returntype, parameter and function names as Add and Sub"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-cpp"},"DOUBLE Add(DOUBLE i, DOUBLE j)\n\nDOUBLE Sub(DOUBLE i, DOUBLE j);\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Three Major classes are created"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-cpp"},"class\xa0CMathOCXApp :\xa0public\xa0COleControlModule    \nclass\xa0CMathOCXCtrl :\xa0public\xa0COleControl    \nclass\xa0CMathOCXPropPage :\xa0public\xa0COlePropertyPage\n")))),(0,r.kt)("h2",{id:"descriptions-of-the-generated-classes--notes"},"Descriptions of the Generated classes & Notes"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"**class\xa0CMathOCXApp :\xa0public\xa0COleControlModule -> CWinApp**\n\n**COleControlModule\xa0provides** member functions for initializing control module it is an application object for running the ActivexControl. Only one global object is present.\n\nclass\xa0CMathOCXCtrl :\xa0public\xa0COleControl\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"COleControl\xa0Derived from CWnd, this class inherits all the functionality of a Windows window object plus additional functionality specific to OLE, such as event firing and the ability to support methods and properties."),(0,r.kt)("li",{parentName:"ol"},"COleControl\xa0has\xa0a dispatch map, which is used to expose a set of functions (called methods) and attributes (called properties) to the control user.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Dispatch Maps")," "),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"OLE Automation provides ways to call methods and to access properties across applications.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'The mechanism supplied by the MFC for dispatching these requests is the "dispatch map," which designates the internal and external names of object functions and properties, as well as the data types of the properties themselves and of function arguments.'))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"DISP_FUNCTION(theClass, pszName, pfnMember, vtRetVal, vtsParams )")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Parameters")," "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"theClass -\xa0Name of the class. "),(0,r.kt)("li",{parentName:"ul"},"pszName -\xa0External name of the function. "),(0,r.kt)("li",{parentName:"ul"},"pfnMember -\xa0Name of the member function."),(0,r.kt)("li",{parentName:"ul"},"vtRetVal -\xa0A value specifying the function's return type. "),(0,r.kt)("li",{parentName:"ul"},"vtsParams -\xa0A space-separated list of one or more constants specifying the function's parameter list.")),(0,r.kt)("p",null,'Example:\xa0DISP_FUNCTION_ID(CMathOCXCtrl,\xa0"Add", dispidAdd, Add, VT_R8, VTS_R8 VTS_R8)'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cpp"},"class\xa0CMathOCXPropPage :\xa0public\xa0COlePropertyPage\n")),(0,r.kt)("p",null,"Used to display the properties of a custom control in a graphical interface, similar to a dialog box."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Using MathOCX.ocx control in the HTML Page")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<HTML>\n<HEAD>\n<META NAME="GENERATOR" Content="Microsoft Visual Studio 8.0">\n<TITLE></TITLE>\n<style type="text/css">\n .style1 {\n    width: 25%;\n    }\n .style2 { \n    color: #0000CC;\n    font-weight: 700;\n    }\n .style3 {\n    width: 213px;\n    }\n</style>\n</HEAD>\n\n<script type="text/javascript">\n    function Button1_onclick() {\n        //Call the MathOCX Add Method\n        Result.value = MathOCX.Add(Text1.value, Text2.value);\n    }\n<\/script>\n\n<BODY onload="initPage()" scroll="no">\n    <table class="style1">\n        <tr>\n            <td class="style2" colspan="2">Addition of two numbers using MathOCX ActiveX Control </td>\n        </tr>\n        <tr>\n            <td class="style3">Enter number :</td>\n            <td><input id="Text1" type="text" /></td>\n        </tr>\n        <tr>\n            <td class="style3"> Enter number :</td>\n            <td><input id="Text2" type="text" /></td>\n        </tr>\n        <tr>\n            <td class="style3"> <input id="Button1" type="button" value="Add" onclick="return Button1_onclick()" />\n                Result:</td>\n            <td>\n                <input id="Result" type="text" />\n            </td>\n        </tr>\n    </table>\n\n\x3c!--Initialize the <span class="hiddenSpellError" pre="the ">MathOCX</span> <span class="hiddenSpellError" pre="">Activex</span> Control using the control GUID --\x3e\n</pre>\n<pre>\n<pre>\n style="left: 0px; top: 0px" width="1" viewastext>\n            <param name="_Version" value="65536"/>\n            <param name="_ExtentX" value="26"/>\n            <param name="_ExtentY" value="26"/>\n            <param name="_StockProps" value="0"/>\n      </object>\n\n</BODY>\n</HTML>\n')))}u.isMDXComponent=!0}}]);