"use strict";(self.webpackChunkNBT=self.webpackChunkNBT||[]).push([["37282"],{24497:function(r,e,n){n.r(e),n.d(e,{frontMatter:()=>c,default:()=>h,contentTitle:()=>a,assets:()=>i,toc:()=>l,metadata:()=>t});var t=JSON.parse('{"id":"articles/MFC/VC6.0ToVC 8.0","title":"VC 6.0 to VC 8.0 Conversion Guide","description":"error C2152 pointers to functions with different attributes db","source":"@site/docs/articles/MFC/VC6.0ToVC 8.0.md","sourceDirName":"articles/MFC","slug":"/articles/MFC/VC6.0ToVC 8.0","permalink":"/docs/articles/MFC/VC6.0ToVC 8.0","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"Articles","previous":{"title":"Splitter Window","permalink":"/docs/articles/MFC/SplitterWindow"},"next":{"title":"Win32 Interview Questions","permalink":"/docs/articles/MFC/Win32 FAQ"}}'),o=n(85893),s=n(50065);let c={},a="VC 6.0 to VC 8.0 Conversion Guide",i={},l=[{value:"error C2152: &#39;=&#39; : pointers to functions with different attributes db",id:"error-c2152---pointers-to-functions-with-different-attributes-db",level:2},{value:"error C2228: left of &#39;.length&#39; must have class/struct/union type",id:"error-c2228-left-of-length-must-have-classstructunion-type",level:2},{value:"error C2259: &#39;CException&#39; : cannot instantiate abstract class",id:"error-c2259-cexception--cannot-instantiate-abstract-class",level:2},{value:"error C2440",id:"error-c2440",level:2},{value:"Error 1 - &#39;static_cast&#39; : cannot convert from &#39;BOOL (__thiscall CSystemSetupDlg::* )(void)&#39; to &#39;AFX_PMSG&#39;",id:"error-1---static_cast--cannot-convert-from-bool-__thiscall-csystemsetupdlg-void-to-afx_pmsg",level:5},{value:"Error 2 - error C2440: &#39;static_cast&#39; : cannot convert from &#39;BOOL (**thiscall CUniOLApp::* )(UINT)&#39; to &#39;void (**thiscall CCmdTarget::* )(UINT)&#39;",id:"error-2---error-c2440-static_cast--cannot-convert-from-bool-thiscall-cuniolapp-uint-to-void-thiscall-ccmdtarget-uint",level:5},{value:"error C2664",id:"error-c2664",level:2},{value:"Error 1 - error C2664: &#39;DDV_MaxChars&#39; : cannot convert parameter 2 from &#39;double&#39; to &#39;const CString &amp;&#39;",id:"error-1---error-c2664-ddv_maxchars--cannot-convert-parameter-2-from-double-to-const-cstring-",level:5},{value:"Error 2 - error C2664: &#39;sprintf&#39; : cannot convert parameter 1 from &#39;TCHAR [250]&#39; to &#39;char *&#39;",id:"error-2---error-c2664-sprintf--cannot-convert-parameter-1-from-tchar-250-to-char-",level:5},{value:"Note: User Manager does not use MFC .Since ATL and Mfc have shared libraries include <code>&lt;atlstr.h&gt;</code>",id:"note-user-manager-does-not-use-mfc-since-atl-and-mfc-have-shared-libraries-include-atlstrh",level:5},{value:"Error 4 - error C2664: &#39;ATL::CRegKey::Create&#39; : cannot convert parameter 2 from &#39;const char [27]&#39; to &#39;LPCTSTR&#39;",id:"error-4---error-c2664-atlcregkeycreate--cannot-convert-parameter-2-from-const-char-27-to-lpctstr",level:5},{value:"Error 5 - error C2664: &#39;MessageBoxW&#39; : cannot convert parameter 2 from &#39;const char [8]&#39; to &#39;LPCWSTR&#39;",id:"error-5---error-c2664-messageboxw--cannot-convert-parameter-2-from-const-char-8-to-lpcwstr",level:5},{value:"Error 7 - error C2664: <code>void ATL::CStringT&lt;BaseType,StringTraits&gt;::Format(const wchar_t_,...)</code> : cannot convert parameter 1 from &#39;const char [4]&#39; to &#39;const wchar_t_&#39;",id:"error-7---error-c2664-void-atlcstringtbasetypestringtraitsformatconst-wchar_t_--cannot-convert-parameter-1-from-const-char-4-to-const-wchar_t_",level:5},{value:"Error 8 - error C2664: &#39;atof&#39; : cannot convert parameter 1 from &#39;class CString&#39; to &#39;const char *&#39;",id:"error-8---error-c2664-atof--cannot-convert-parameter-1-from-class-cstring-to-const-char-",level:5},{value:"error code 3867",id:"error-code-3867",level:2},{value:"error 2039 &#39;ReadHuge&#39; : is not a member of &#39;CFile&#39;",id:"error-2039-readhuge--is-not-a-member-of-cfile",level:2},{value:"error C2065: &#39;i&#39; : undeclared identifier",id:"error-c2065-i--undeclared-identifier",level:2}];function d(r){let e={code:"code",h1:"h1",h2:"h2",h5:"h5",header:"header",p:"p",pre:"pre",strong:"strong",...(0,s.a)(),...r.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"vc-60-to-vc-80-conversion-guide",children:"VC 6.0 to VC 8.0 Conversion Guide"})}),"\n",(0,o.jsx)(e.h2,{id:"error-c2152---pointers-to-functions-with-different-attributes-db",children:"error C2152: '=' : pointers to functions with different attributes db"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:'#include<windows.h>\r\nHANDLE h;\r\nvoid (*f)(int, int);\r\nint _stdcall WinMain( HINSTANCE i, HINSTANCE j, char *k, int l )\r\n{\r\nh = LoadLibrary("z1.dll");\r\nf = GetProcAddress(h,"abc");\r\n}\n'})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Solution"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:'#include<windows.h>\r\nHANDLE h;\r\nvoid (_stdcall *f)(int, int);\r\nint _stdcall WinMain( HINSTANCE i, HINSTANCE j, char *k, int l )\r\n{\r\nh = LoadLibrary("z1.dll");\r\nf = GetProcAddress(h,"abc");\r\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"error-c2228-left-of-length-must-have-classstructunion-type",children:"error C2228: left of '.length' must have class/struct/union type"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:'string GetNewPin(string) {\r\ndo {\r\ncout << "Enter new PIN number: ";\r\ncin >> newPin;\r\n} while(int(newPin.length) != 4); //error C2228\r\nreturn newPin;\r\n}\n'})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Solution"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"while( newPin.length() != 4); // length() is a memberfunction of string\n"})}),"\n",(0,o.jsx)(e.h2,{id:"error-c2259-cexception--cannot-instantiate-abstract-class",children:"error C2259: 'CException' : cannot instantiate abstract class"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"Catch(CEXception e)\n"})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Reason"})}),"\n",(0,o.jsx)(e.p,{children:"As MFC throws Exceptions as pointers to exception as there was no such pointer to exception it is resolved by including pointer to exception"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"solution"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"Catch(CEXception *e)\n"})}),"\n",(0,o.jsx)(e.h2,{id:"error-c2440",children:"error C2440"}),"\n",(0,o.jsx)(e.h5,{id:"error-1---static_cast--cannot-convert-from-bool-__thiscall-csystemsetupdlg-void-to-afx_pmsg",children:"Error 1 - 'static_cast' : cannot convert from 'BOOL (__thiscall CSystemSetupDlg::* )(void)' to 'AFX_PMSG'"}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"Reason:"}),"\r\nAs the ON Message handler expects the return type as Void as the return type was BOOL it was converted to void using pointer to member funtion.\r\nerror C2440: 'static_cast' : cannot convert from 'BOOL (__thiscall CUniOLDoc::* )(void)' to 'AFX_PMSG' ON_COMMAND(ID_RUN_ENDRUN, OnEndRun)"]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Solution"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"typedef void (CUniOLDoc::*ptrHandler)();\r\nON_COMMAND(ID_RUN_ENDRUN, (ptrHandler)OnEndRun)\n"})}),"\n",(0,o.jsx)(e.h5,{id:"error-2---error-c2440-static_cast--cannot-convert-from-bool-thiscall-cuniolapp-uint-to-void-thiscall-ccmdtarget-uint",children:"Error 2 - error C2440: 'static_cast' : cannot convert from 'BOOL (**thiscall CUniOLApp::* )(UINT)' to 'void (**thiscall CCmdTarget::* )(UINT)'"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Reason:"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"ON_COMMAND_RANGE(ID_FILE_MRU_FILE1,ID_FILE_MRU_FILE4,OnOpenRecentFile)\r\nON_COMMAND_RANGE always expect to be return type of void.\n"})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Solution"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"ON_COMMAND_RANGE(ID_FILE_MRU_FILE1,ID_FILE_MRU_FILE4,(void (__thiscall CCmdTarget::* )(UINT))OnOpenRecentFile)\n"})}),"\n",(0,o.jsx)(e.h2,{id:"error-c2664",children:"error C2664"}),"\n",(0,o.jsx)(e.h5,{id:"error-1---error-c2664-ddv_maxchars--cannot-convert-parameter-2-from-double-to-const-cstring-",children:"Error 1 - error C2664: 'DDV_MaxChars' : cannot convert parameter 2 from 'double' to 'const CString &'"}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"Reason :"}),"\r\nAs the Second Parameter in DDV_MAxChars takes strictly of string variables as there was of double type"]}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"Solution:"}),"\r\nThe double varaiables are formated to string type."]}),"\n",(0,o.jsx)(e.h5,{id:"error-2---error-c2664-sprintf--cannot-convert-parameter-1-from-tchar-250-to-char-",children:"Error 2 - error C2664: 'sprintf' : cannot convert parameter 1 from 'TCHAR [250]' to 'char *'"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"sprintf(szQuery,\"INSERT INTO tSupportUnitInfo(txtSUName,txtProductSetup,txtSystemSetup,txtCOMPort) VALUES('%s','%s','%s','%s')\",CString(bstrSU),CString(bstrPS),CString(bstrSS),CString(bstrPort));\n"})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Solution:"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"CString szQuery;szQuery.Format(\"INSERT INTO tSupportUnitInfo(txtSUName,txtProductSetup,txtSystemSetup,txtCOMPort) VALUES('%s','%s','%s','%s')\",CString(bstrSU),CString(bstrPS),CString(bstrSS),CString(bstrPort));\r\n\n"})}),"\n",(0,o.jsxs)(e.h5,{id:"note-user-manager-does-not-use-mfc-since-atl-and-mfc-have-shared-libraries-include-atlstrh",children:["Note: User Manager does not use MFC .Since ATL and Mfc have shared libraries include ",(0,o.jsx)(e.code,{children:"<atlstr.h>"})]}),"\n",(0,o.jsxs)(e.p,{children:['so that the error "CString ',":Undeclared",' identifier" is eliminated.']}),"\n",(0,o.jsx)(e.h5,{id:"error-4---error-c2664-atlcregkeycreate--cannot-convert-parameter-2-from-const-char-27-to-lpctstr",children:"Error 4 - error C2664: 'ATL::CRegKey::Create' : cannot convert parameter 2 from 'const char [27]' to 'LPCTSTR'"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:'if( objReg.Create(HKEY_LOCAL_MACHINE,"SOFTWARE\\\\EClient\\\\") == ERROR_SUCCESS )\n'})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Solution:"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:'if( objReg.Create(HKEY_LOCAL_MACHINE,_T("SOFTWARE\\\\ EClient \\\\")) == ERROR_SUCCESS )\n'})}),"\n",(0,o.jsx)(e.h5,{id:"error-5---error-c2664-messageboxw--cannot-convert-parameter-2-from-const-char-8-to-lpcwstr",children:"Error 5 - error C2664: 'MessageBoxW' : cannot convert parameter 2 from 'const char [8]' to 'LPCWSTR'"}),"\n",(0,o.jsx)(e.p,{children:'MessageBox(NULL,"success","Job Transfer",MB_OK);'}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Solution:"})}),"\n",(0,o.jsx)(e.p,{children:'MessageBox(NULL,_T("success"),_T("Job Transfer"),MB_OK);'}),"\n",(0,o.jsxs)(e.h5,{id:"error-7---error-c2664-void-atlcstringtbasetypestringtraitsformatconst-wchar_t_--cannot-convert-parameter-1-from-const-char-4-to-const-wchar_t_",children:["Error 7 - error C2664: ",(0,o.jsx)(e.code,{children:"void ATL::CStringT<BaseType,StringTraits>::Format(const wchar_t_,...)"})," : cannot convert parameter 1 from 'const char [4]' to 'const wchar_t_'"]}),"\n",(0,o.jsx)(e.p,{children:'CString str ; str.Format("%ld",lngError) ;'}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Solution:"})}),"\n",(0,o.jsx)(e.p,{children:'CString str ; str.Format(_T("%ld"),lngError) ;'}),"\n",(0,o.jsx)(e.h5,{id:"error-8---error-c2664-atof--cannot-convert-parameter-1-from-class-cstring-to-const-char-",children:"Error 8 - error C2664: 'atof' : cannot convert parameter 1 from 'class CString' to 'const char *'"}),"\n",(0,o.jsx)(e.p,{children:"*fltUVTarget=(float)atof(CString(bstrValue));"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Solution:"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"USES_CONVERSION ;\r\nLPCSTR strval = W2A(bstrValue);\r\n*fltUVTarget=(float)atof(strval);\n"})}),"\n",(0,o.jsx)(e.h2,{id:"error-code-3867",children:"error code 3867"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"class A\r\n{\r\npublic:\r\n int Test(void);\r\n};\r\n\r\nvoid fun(int (A::*test) (void));\r\n\r\nint main()\r\n{\r\n fun(A::Test);//C3867 error in VC\r\n return 0;\r\n}\n"})}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"Reason:"}),"\r\nTo create a pointer to a member function, the address of operator (&) must be used with the fully qualified name of the method. Not having to use the & operator and the fully qualified name of the method lead to logic bugs in code due missing parenthesis in function calls."]}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"Solution:"}),"\r\nAdd &.\r\nfun(&A::Test);"]}),"\n",(0,o.jsx)(e.h2,{id:"error-2039-readhuge--is-not-a-member-of-cfile",children:"error 2039 'ReadHuge' : is not a member of 'CFile'"}),"\n",(0,o.jsx)(e.p,{children:"objJobFile.ReadHuge(pData,dwFileLength) ;"}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"Solution"}),"\r\nobjJobFile.Read(pData,dwFileLength) ;"]}),"\n",(0,o.jsx)(e.h2,{id:"error-c2065-i--undeclared-identifier",children:"error C2065: 'i' : undeclared identifier"}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"Reason:"}),"\r\nAs the variable was not declared in the for loop."]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"for(i = 0; i<10; i++)\r\n{\r\n}\n"})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Solution"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"for(int i = 0; i<10; i++)\r\n{\r\n}\n"})})]})}function h(r={}){let{wrapper:e}={...(0,s.a)(),...r.components};return e?(0,o.jsx)(e,{...r,children:(0,o.jsx)(d,{...r})}):d(r)}},50065:function(r,e,n){n.d(e,{Z:()=>a,a:()=>c});var t=n(67294);let o={},s=t.createContext(o);function c(r){let e=t.useContext(s);return t.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function a(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(o):r.components||o:c(r.components),t.createElement(s.Provider,{value:e},r.children)}}}]);