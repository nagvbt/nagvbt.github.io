"use strict";(self.webpackChunkNBT=self.webpackChunkNBT||[]).push([["31634"],{8301:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>c,default:()=>h,toc:()=>l,metadata:()=>s,assets:()=>a,contentTitle:()=>o});var s=JSON.parse('{"id":"articles/MFC/COM/COM-Basics","title":"COM Basics","description":"1. Definition\xa0of COM","source":"@site/docs/articles/MFC/COM/COM-Basics.md","sourceDirName":"articles/MFC/COM","slug":"/articles/MFC/COM/COM-Basics","permalink":"/docs/articles/MFC/COM/COM-Basics","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"Articles","previous":{"title":"MFC","permalink":"/docs/category/mfc-1"},"next":{"title":"ATL, ActiveX FAQ","permalink":"/docs/articles/MFC/COM/atl-faq"}}'),i=t(85893),r=t(50065);let c={},o="COM Basics",a={},l=[{value:"1. Definition\xa0of COM",id:"1-definitionof-com",level:2},{value:"2. Advantages of COM",id:"2-advantages-of-com",level:2},{value:"3. Definitions of the COM Basic Elements",id:"3-definitions-of-the-com-basic-elements",level:2},{value:"COM Component",id:"com-component",level:3},{value:"Types of Components",id:"types-of-components",level:3},{value:"COM Interface",id:"com-interface",level:3},{value:"The IUnknown Interface",id:"the-iunknown-interface",level:3},{value:"4. Working with COM Objects",id:"4-working-with-com-objects",level:2},{value:"Creating a new object",id:"creating-a-new-object",level:4},{value:"Deleting objects",id:"deleting-objects",level:4},{value:"5. FAQ",id:"5-faq",level:2}];function d(e){let n={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"com-basics",children:"COM Basics"})}),"\n",(0,i.jsx)(n.h2,{id:"1-definitionof-com",children:"1. Definition\xa0of COM"}),"\n",(0,i.jsxs)(n.p,{children:["COM is a\xa0acronym for Microsoft COMPONENT OBJECT MODEL and it is a specification.",(0,i.jsx)(n.br,{}),"\n","COM is a platform-independent, distributed, object-oriented system which provides a standard for binary components and clients to interact with each other"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"COM is not a"})," - Launguage"]}),"\n",(0,i.jsx)(n.h2,{id:"2-advantages-of-com",children:"2. Advantages of COM"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Loose Coupling:\xa0In a software, that uses COM objects, we can easily replace an existing COM object with another COM object written in entirely another language as long as the signatures of the methods in both the COM objects remain same. In that case, there will not be any change in the existing software code that uses the COM object."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Allows dynamic loading and unloading of components: Just visualize them as plug and play devices, just plug it in and it starts working. Pull it out when you don't need it."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Code Reusability: Once a COM component is created, it can be used any number of times in any number of projects as you like."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"3-definitions-of-the-com-basic-elements",children:"3. Definitions of the COM Basic Elements"}),"\n",(0,i.jsx)(n.h3,{id:"com-component",children:"COM Component"}),"\n",(0,i.jsxs)(n.p,{children:["A component is a ",(0,i.jsx)(n.em,{children:"language independent"})," which can be shipped in ",(0,i.jsx)(n.em,{children:"binary"})," form and Expose their functionality through an ",(0,i.jsx)(n.em,{children:"interface"})," mechanism and can be ",(0,i.jsx)(n.em,{children:"upgraded"})," with out breaking old clients.\xa0COM Component can be developed using\xa0programming language like \xa0C++, Visual Basic,\xa0Delphi\xa0etc."]}),"\n",(0,i.jsx)(n.h3,{id:"types-of-components",children:"Types of Components"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"In-process:"})," In-Process components are (DLLs) Dynamic Link Libraries. They run in the memory space of client application (so they are termed as in-process)."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Out-process:"})," Out-Process components are (EXEs) Executables. They run in a different memory space as that of client application (so they are termed as out-process)."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Remote:"})," Remote components are just like any other component but the only difference is that remote components run from a separate remote location via a network. They are implemented using DCOM (Distributed COM)."]}),"\n",(0,i.jsx)(n.h3,{id:"com-interface",children:"COM Interface"}),"\n",(0,i.jsxs)(n.p,{children:["A COM object\u2019s interface provides a memory lay out of functions that Clients access. An\xa0",(0,i.jsx)(n.em,{children:"interface"}),"\xa0is a ",(0,i.jsx)(n.strong,{children:"contract"})," that consists of a group of function prototypes whose usage is defined but whose implementation is not.\xa0\xa0An Interface is equivalent to a structure with pointers to functions."]}),"\n",(0,i.jsx)(n.p,{children:"\u2022 The Client calls the Server Functions through\xa0interface"}),"\n",(0,i.jsx)(n.p,{children:"In C++ the interface can be represented as a class with pure virtual functions."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"class CInterface\r\n{\r\nvirtual void **stdcall Fun1( ) = 0;\r\nvirtual void** stdcall Fun2( ) = 0;\r\nvirtual void __stdcall Fun3( ) = 0;\r\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:["*",(0,i.jsx)(n.strong,{children:"*All COM objects must implement the IUnknown interface**"})]}),"\n",(0,i.jsx)(n.h3,{id:"the-iunknown-interface",children:"The IUnknown Interface"}),"\n",(0,i.jsx)(n.p,{children:"IUnknown, contains three vital methods:\xa0QueryInterface,\xa0AddRef, and\xa0Release"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Method"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"AddRef"})}),(0,i.jsx)(n.td,{children:"Increments the reference count for an interface on an object."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"QueryInterface"})}),(0,i.jsx)(n.td,{children:"Retrieves pointers to the supported interfaces on an object."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Release"})}),(0,i.jsx)(n.td,{children:"Decrements the reference count for an interface on an object."})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code Snippet"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"interface IUnknown\r\n{\r\n//IUnknown Functions\r\nvirtual ULONG **stdcall AddRef() = 0;\r\nvirtual ULONG** stdcall Release() = 0;\r\nvirtual HRESULT __stdcall QueryInterface( REFIID riid, void** ppv ) = 0;\r\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["*",(0,i.jsx)(n.strong,{children:"*stdcall****"}),": The** stdcall calling convention in which"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The callee is responsible\xa0for\xa0cleaning up the stack"}),"\n",(0,i.jsx)(n.li,{children:"The parameters are pushed onto the stack in right-to-left order"}),"\n",(0,i.jsx)(n.li,{children:"Registers EAX, ECX, and EDX are designated for use within the function."}),"\n",(0,i.jsx)(n.li,{children:"Return values are stored in the EAX register."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"HRESULT"})," :\xa0HRESULT 32-bit data type that indicate the status of an operation. For more information on HRESULT See ",(0,i.jsx)(n.a,{href:"http://msdn.microsoft.com/en-us/library/bb401631.aspx",children:"Developer tools, technical documentation and coding examples | Microsoft Docs"})]}),"\n",(0,i.jsx)(n.h2,{id:"4-working-with-com-objects",children:"4. Working with COM Objects"}),"\n",(0,i.jsx)(n.h4,{id:"creating-a-new-object",children:"Creating a new object"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["In C++, use\xa0",(0,i.jsx)(n.code,{children:"operator\xa0**new**"}),"\xa0or create an object on the stack."]}),"\n",(0,i.jsxs)(n.li,{children:["In COM, call an API in the COM library ",(0,i.jsx)(n.strong,{children:"CoCreateInstance"})]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"deleting-objects",children:"Deleting objects"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In C++, use\xa0",(0,i.jsx)(n.code,{children:"operator\xa0**delete**"}),"\xa0or let a stack object go out of scope."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"In COM, all objects keep their own reference counts. The caller must tell the object when the caller is done using the object. COM objects free themselves from memory when the reference count reaches 0."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Call ",(0,i.jsx)(n.strong,{children:"Release"}),"()\xa0method to tell the COM object that you no longer need it. Once we call\xa0",(0,i.jsx)(n.code,{children:"Release()"}),", we must not use the interface pointer any more, since the COM object may disappear from memory at any time."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"Using **CoFreeUnusedLibraries**()"}),"\xa0API during your idle processing unloads any COM servers that have no outstanding references, so this also reduces your Clients's memory usage."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"5-faq",children:"5. FAQ"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["What is COM?",(0,i.jsx)(n.br,{}),"\n","check - Definition of COM"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Why COM ?",(0,i.jsx)(n.br,{}),"\n","check - 1. Advantages of COM"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["What is a COM Component?",(0,i.jsx)(n.br,{}),"\n","check - 2. Definitions of the COM Basic Elements"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["What are the types of components?",(0,i.jsx)(n.br,{}),"\n","check - 2. Definitions of the COM Basic Elements"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["What is an Interface ?",(0,i.jsx)(n.br,{}),"\n","check - COM Interface"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["What is the basic Interface to be implemented in COM?",(0,i.jsx)(n.br,{}),"\n","IUnknown"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["What are methods of IUnknown?",(0,i.jsx)(n.br,{}),"\n","check - The IUnknown Interface"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["How to create an COM Object?",(0,i.jsx)(n.br,{}),"\n","check -\xa04. Working with COM Objects"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["How to delete a COM Object?",(0,i.jsx)(n.br,{}),"\n","check -\xa04. Working with COM Objects"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["When to use\xa0CoFreeUnusedLibraries ?",(0,i.jsx)(n.br,{}),"\n","check -\xa04. Working with COM Objects"]}),"\n"]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},50065:function(e,n,t){t.d(n,{Z:()=>o,a:()=>c});var s=t(67294);let i={},r=s.createContext(i);function c(e){let n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);